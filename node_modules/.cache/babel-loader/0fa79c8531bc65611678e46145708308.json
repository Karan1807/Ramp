{"ast":null,"code":"import { getEmployees, getTransactionsPaginated, getTransactionsByEmployee, setTransactionApproval } from \"./requests\";\nconst timeout = getTimeout();\nconst mockTimeout = 1 * timeout;\nexport function fakeFetch(endpoint, params) {\n  return new Promise((resolve, reject) => {\n    mockApiLogger({\n      message: \"Loading request\",\n      data: {\n        endpoint,\n        params\n      },\n      type: \"info\"\n    });\n    let result;\n\n    try {\n      switch (endpoint) {\n        case \"employees\":\n          result = getEmployees();\n          setTimeout(() => {\n            mockApiLogger({\n              data: {\n                endpoint,\n                params,\n                result\n              }\n            });\n            resolve(result);\n          }, mockTimeout);\n          break;\n\n        case \"paginatedTransactions\":\n          result = getTransactionsPaginated(params);\n          setTimeout(() => {\n            mockApiLogger({\n              data: {\n                endpoint,\n                params,\n                result\n              }\n            });\n            resolve(result);\n          }, mockTimeout * 2.5);\n          break;\n\n        case \"transactionsByEmployee\":\n          {\n            const {\n              employeeId\n            } = params;\n\n            if (!employeeId) {\n              const allTransactions = getTransactionsPaginated({\n                page: 0\n              }).data;\n              result = allTransactions;\n            } else {\n              result = getTransactionsByEmployee({\n                employeeId\n              });\n            }\n\n            setTimeout(() => {\n              mockApiLogger({\n                data: {\n                  endpoint,\n                  params,\n                  result\n                }\n              });\n              resolve(result);\n            }, mockTimeout * 1.5);\n            break;\n          }\n\n        case \"setTransactionApproval\":\n          result = setTransactionApproval(params);\n          setTimeout(() => {\n            mockApiLogger({\n              data: {\n                endpoint,\n                params,\n                result\n              }\n            });\n            resolve(result);\n          }, mockTimeout * 1);\n          break;\n\n        default:\n          throw new Error(\"Invalid endpoint\");\n      }\n    } catch (error) {\n      if (error instanceof Error) {\n        mockApiLogger({\n          message: error.message,\n          data: {\n            endpoint,\n            params\n          },\n          type: \"error\"\n        });\n        reject(error.message);\n      }\n    }\n  });\n}\n\nfunction mockApiLogger(_ref) {\n  let {\n    data,\n    message = \"Success request\",\n    type = \"success\"\n  } = _ref;\n\n  if (process.env.REACT_APP_MOCK_REQUEST_LOGS_ENABLED === \"false\") {\n    return;\n  }\n\n  console.log(`%c--Fake Request Debugger-- %c${message}`, \"color: #717171\", getTitleColor());\n  console.log(data);\n\n  function getTitleColor() {\n    if (type === \"error\") return \"color: #d93e3e;\";\n    if (type === \"info\") return \"color: #1670d2;\";\n    return \"color: #548a54;\";\n  }\n}\n\nfunction getTimeout() {\n  var _ref2, _URL$searchParams$get;\n\n  const timeout = parseInt((_ref2 = (_URL$searchParams$get = new URL(document.location).searchParams.get(\"timeout\")) !== null && _URL$searchParams$get !== void 0 ? _URL$searchParams$get : process.env.REACT_APP_TIMEOUT_MULTIPLIER) !== null && _ref2 !== void 0 ? _ref2 : \"1000\");\n  return Number.isNaN(timeout) ? 1000 : timeout;\n}","map":{"version":3,"names":["getEmployees","getTransactionsPaginated","getTransactionsByEmployee","setTransactionApproval","timeout","getTimeout","mockTimeout","fakeFetch","endpoint","params","Promise","resolve","reject","mockApiLogger","message","data","type","result","setTimeout","employeeId","allTransactions","page","Error","error","process","env","REACT_APP_MOCK_REQUEST_LOGS_ENABLED","console","log","getTitleColor","parseInt","URL","document","location","searchParams","get","REACT_APP_TIMEOUT_MULTIPLIER","Number","isNaN"],"sources":["/Users/karansavaliya/Desktop/ramp-fe-challenge/src/utils/fetch.ts"],"sourcesContent":["import {\n  getEmployees,\n  getTransactionsPaginated,\n  getTransactionsByEmployee,\n  setTransactionApproval,\n} from \"./requests\"\nimport {\n  PaginatedRequestParams,\n  RequestByEmployeeParams,\n  SetTransactionApprovalParams,\n} from \"./types\"\n\nconst timeout = getTimeout()\nconst mockTimeout = 1 * timeout\n\nexport function fakeFetch<TData, TParams extends object = object>(\n  endpoint: RegisteredEndpoints,\n  params?: TParams\n): Promise<TData> {\n  return new Promise((resolve, reject) => {\n    mockApiLogger({\n      message: \"Loading request\",\n      data: { endpoint, params },\n      type: \"info\",\n    })\n\n    let result: TData\n\n    try {\n      switch (endpoint) {\n        case \"employees\":\n          result = getEmployees() as unknown as TData\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout)\n          break\n\n        case \"paginatedTransactions\":\n          result = getTransactionsPaginated(params as PaginatedRequestParams) as unknown as TData\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout * 2.5)\n          break\n\n        case \"transactionsByEmployee\": {\n          const { employeeId } = params as RequestByEmployeeParams\n\n         \n          if (!employeeId) {\n            const allTransactions = getTransactionsPaginated({ page: 0 }).data\n            result = allTransactions as unknown as TData\n          } else {\n            result = getTransactionsByEmployee({ employeeId }) as unknown as TData\n          }\n\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout * 1.5)\n          break\n        }\n\n        case \"setTransactionApproval\":\n          result = setTransactionApproval(params as SetTransactionApprovalParams) as unknown as TData\n          setTimeout(() => {\n            mockApiLogger({ data: { endpoint, params, result } })\n            resolve(result)\n          }, mockTimeout * 1)\n          break\n\n        default:\n          throw new Error(\"Invalid endpoint\")\n      }\n    } catch (error) {\n      if (error instanceof Error) {\n        mockApiLogger({\n          message: error.message,\n          data: { endpoint, params },\n          type: \"error\",\n        })\n        reject(error.message)\n      }\n    }\n  })\n}\n\nfunction mockApiLogger({\n  data,\n  message = \"Success request\",\n  type = \"success\",\n}: {\n  message?: string\n  data: object\n  type?: \"success\" | \"error\" | \"info\"\n}) {\n  if (process.env.REACT_APP_MOCK_REQUEST_LOGS_ENABLED === \"false\") {\n    return\n  }\n\n  console.log(`%c--Fake Request Debugger-- %c${message}`, \"color: #717171\", getTitleColor())\n  console.log(data)\n\n  function getTitleColor() {\n    if (type === \"error\") return \"color: #d93e3e;\"\n    if (type === \"info\") return \"color: #1670d2;\"\n    return \"color: #548a54;\"\n  }\n}\n\nfunction getTimeout() {\n  const timeout = parseInt(\n    new URL(document.location as unknown as URL).searchParams.get(\"timeout\") ??\n      process.env.REACT_APP_TIMEOUT_MULTIPLIER ??\n      \"1000\"\n  )\n  return Number.isNaN(timeout) ? 1000 : timeout\n}\n\nexport type RegisteredEndpoints =\n  | \"employees\"\n  | \"paginatedTransactions\"\n  | \"transactionsByEmployee\"\n  | \"setTransactionApproval\"\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}